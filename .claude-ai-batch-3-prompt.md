# RaceSync - Batch 3: Sample Data & Storage Keys (T023-T024)

## Context

You're working on **RaceSync**, a mobile app for Le Mans Ultimate race schedule tracking. The project has React Native initialized with TypeScript strict mode, type definitions, and utility functions all complete.

**What's Done:**
- ✅ Project setup (React Native 0.82.1 + TypeScript strict mode)
- ✅ Type definitions (Race, Favorite, RaceCategory, CalendarEvent, PracticeSession, Notification)
- ✅ Utility functions (dateUtils, timezoneUtils, formatters) - 103 tests passing, 98.24% coverage
- ✅ Constants (race colors, spacing values)

**Current Branch:** `001-lmu-schedule-tracker`

**GitHub Repository:** https://github.com/[YOUR_USERNAME]/racesync/tree/001-lmu-schedule-tracker

## Project Specifications

Read these specs from the GitHub repository:

1. **Data Model:** `specs/001-lmu-schedule-tracker/data-model.md`
2. **Type Definitions:** Check `src/features/*/types/` for existing types
3. **Research:** `specs/001-lmu-schedule-tracker/research.md` (for AsyncStorage schema)

## Your Tasks

Create **2 foundational files** for data storage and sample data:

### Task T023: Sample Race Data
**File:** `src/data/sampleSchedule.json`

**Purpose:** Realistic sample race data for testing and development before API integration.

**Requirements:**

1. **Structure:** JSON file matching the data model from `specs/001-lmu-schedule-tracker/data-model.md`

2. **Race Types:** Include all three types:
   - **Daily Races (3 tiers)**:
     - Daily Race A (Beginner) - LMP2
     - Daily Race B (Intermediate) - Hypercar
     - Daily Race C (Advanced) - LMGT3
   - **Weekly Races (2 races)**:
     - Weekly Endurance (Hypercar, 90 minutes)
     - Weekly Sprint (Multi-class, 60 minutes)
   - **Special Events (2 races)**:
     - Special 24h Event (Multi-class, 360 minutes)
     - Special Championship Round (Hypercar, 240 minutes)

3. **Data Requirements:**
   - Minimum 7 races total (3 daily + 2 weekly + 2 special)
   - Use real Le Mans Ultimate tracks:
     - Circuit de la Sarthe (various layouts)
     - Spa-Francorchamps
     - Monza
     - Daytona
     - Sebring
     - Watkins Glen
   - All timestamps in **ISO 8601 UTC format** (e.g., "2024-03-15T14:30:00Z")
   - Daily races: `repeatInterval` = 120 (2 hours)
   - Weekly/Special: `repeatInterval` = null
   - Mix of weather conditions: Clear, Dynamic, Real Weather
   - Mix of time of day: Morning, Afternoon, Sunset, Night, Full Day Cycle
   - License requirements: Bronze, Silver, Gold

4. **Realistic Timing:**
   - Daily races: Start times throughout the day (every 2 hours)
   - Weekly races: Weekend timing (Saturday/Sunday afternoons)
   - Special events: Long duration (4-6 hours)
   - At least 2 races should have `startTime` in the near future (for testing "upcoming" states)
   - At least 1 race should be currently live (for testing `isLive` state)

5. **Schema Structure:**
```json
{
  "dailyRaces": {
    "tierA": [{ /* Race objects */ }],
    "tierB": [{ /* Race objects */ }],
    "tierC": [{ /* Race objects */ }]
  },
  "weeklyRaces": [{ /* Race objects */ }],
  "specialEvents": [{ /* Race objects */ }]
}
```

6. **Example Race Object:**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "type": "daily",
  "tier": "intermediate",
  "trackName": "Circuit de la Sarthe",
  "trackConfiguration": "24h Layout",
  "carClass": "Hypercar",
  "startTime": "2024-03-15T14:30:00Z",
  "durationMinutes": 45,
  "weatherCondition": "Dynamic",
  "timeOfDay": "Afternoon",
  "licenseRequirement": "Silver",
  "repeatInterval": 120,
  "isLive": false
}
```

### Task T024: Storage Keys Constants
**File:** `src/shared/constants/storageKeys.ts`

**Purpose:** Centralized AsyncStorage keys for all data persistence.

**Requirements:**

1. **All Storage Keys:** Define constants for all AsyncStorage keys used in the app:
   - Schedule cache
   - Favorites
   - Calendar mappings
   - Scheduled notifications
   - User preferences (filters, settings)
   - Last update timestamp

2. **Naming Convention:**
   - Prefix all keys with `racesync:`
   - Use kebab-case for multi-word keys
   - Keep keys descriptive but concise

3. **TypeScript Requirements:**
   - Export as `const` objects for type safety
   - Use `as const` for readonly values
   - Add JSDoc comments explaining what each key stores

4. **Expected Keys:**
```typescript
export const STORAGE_KEYS = {
  // Race schedule data
  SCHEDULE: 'racesync:schedule',
  SCHEDULE_LAST_UPDATED: 'racesync:schedule-last-updated',

  // User favorites
  FAVORITES: 'racesync:favorites',

  // Calendar integration
  CALENDAR_MAPPINGS: 'racesync:calendar-mappings',

  // Notifications
  SCHEDULED_NOTIFICATIONS: 'racesync:scheduled-notifications',

  // User preferences
  SELECTED_FILTER: 'racesync:selected-filter',
  THEME: 'racesync:theme',
} as const;
```

5. **Helper Types:**
```typescript
// Type for all valid storage keys
export type StorageKey = typeof STORAGE_KEYS[keyof typeof STORAGE_KEYS];

// Type for storage key prefixes (for bulk operations)
export const STORAGE_PREFIX = 'racesync:' as const;
```

6. **Documentation:**
   - Add JSDoc comments for each key explaining:
     - What data it stores
     - Data type (string, JSON, number)
     - Example value
   - Add usage examples in JSDoc

## Implementation Requirements

### 1. TypeScript Strict Mode
- Use proper TypeScript types
- No `any` types
- `storageKeys.ts` should export properly typed constants

### 2. Data Quality (T023)
- **Valid JSON**: Must parse without errors
- **Realistic UUIDs**: Use proper UUID v4 format
- **Consistent timestamps**: All in UTC ISO 8601 format
- **Realistic track names**: Use actual Le Mans Ultimate circuits
- **Proper car classes**: Only use valid classes (LMP2, Hypercar, LMGT3, Multi-class)

### 3. Code Quality (T024)
- **File size limit:** <200 lines
- **Comprehensive JSDoc comments** on all constants
- **Example usage** in JSDoc

### 4. Validation
- `sampleSchedule.json` should match the Race type definition exactly
- All required fields must be present
- Field types must match (strings for strings, numbers for numbers, etc.)
- No extra/unknown fields

## Example Implementation

### sampleSchedule.json (partial)
```json
{
  "dailyRaces": {
    "tierA": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "type": "daily",
        "tier": "beginner",
        "trackName": "Daytona International Speedway",
        "trackConfiguration": "Road Course",
        "carClass": "LMP2",
        "startTime": "2024-03-15T12:00:00Z",
        "durationMinutes": 30,
        "weatherCondition": "Clear",
        "timeOfDay": "Afternoon",
        "licenseRequirement": "Bronze",
        "repeatInterval": 120,
        "isLive": false
      }
    ],
    "tierB": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "type": "daily",
        "tier": "intermediate",
        "trackName": "Circuit de la Sarthe",
        "trackConfiguration": "24h Layout",
        "carClass": "Hypercar",
        "startTime": "2024-03-15T14:30:00Z",
        "durationMinutes": 45,
        "weatherCondition": "Dynamic",
        "timeOfDay": "Afternoon",
        "licenseRequirement": "Silver",
        "repeatInterval": 120,
        "isLive": false
      }
    ],
    "tierC": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440002",
        "type": "daily",
        "tier": "advanced",
        "trackName": "Spa-Francorchamps",
        "trackConfiguration": null,
        "carClass": "LMGT3",
        "startTime": "2024-03-15T16:00:00Z",
        "durationMinutes": 60,
        "weatherCondition": "Real Weather",
        "timeOfDay": "Sunset",
        "licenseRequirement": "Gold",
        "repeatInterval": 120,
        "isLive": false
      }
    ]
  },
  "weeklyRaces": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440003",
      "type": "weekly",
      "tier": null,
      "trackName": "Monza",
      "trackConfiguration": "GP Circuit",
      "carClass": "Hypercar",
      "startTime": "2024-03-16T15:00:00Z",
      "durationMinutes": 90,
      "weatherCondition": "Dynamic",
      "timeOfDay": "Afternoon",
      "licenseRequirement": "Silver",
      "repeatInterval": null,
      "isLive": false
    }
  ],
  "specialEvents": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440005",
      "type": "special",
      "tier": null,
      "trackName": "Circuit de la Sarthe",
      "trackConfiguration": "24h Layout",
      "carClass": "Multi-class",
      "startTime": "2024-03-20T18:00:00Z",
      "durationMinutes": 360,
      "weatherCondition": "Real Weather",
      "timeOfDay": "Full Day Cycle",
      "licenseRequirement": "Gold",
      "repeatInterval": null,
      "isLive": false
    }
  ]
}
```

### storageKeys.ts
```typescript
/**
 * AsyncStorage keys for RaceSync data persistence
 *
 * All keys are prefixed with 'racesync:' to avoid conflicts
 * with other apps or libraries using AsyncStorage.
 *
 * @see specs/001-lmu-schedule-tracker/data-model.md for data schemas
 */

/**
 * Storage keys for all persisted data
 */
export const STORAGE_KEYS = {
  /**
   * Race schedule cache
   * Type: JSON string (RaceSchedule object)
   * Example: { dailyRaces: {...}, weeklyRaces: [...], specialEvents: [...] }
   */
  SCHEDULE: 'racesync:schedule',

  /**
   * Last time schedule was updated from API
   * Type: ISO 8601 UTC string
   * Example: "2024-03-15T14:30:00Z"
   */
  SCHEDULE_LAST_UPDATED: 'racesync:schedule-last-updated',

  /**
   * User's favorited races
   * Type: JSON array of Favorite objects
   * Example: [{ raceId: "...", favoritedAt: "...", notificationEnabled: true }]
   */
  FAVORITES: 'racesync:favorites',

  /**
   * Calendar event mappings (eventId <-> raceId/practiceSessionId)
   * Type: JSON array of CalendarMapping objects
   * Example: [{ eventId: "...", raceId: "...", practiceSessionId: null }]
   */
  CALENDAR_MAPPINGS: 'racesync:calendar-mappings',

  /**
   * Scheduled notification mappings
   * Type: JSON array of Notification objects
   * Example: [{ id: "...", notificationType: "favorite-reminder", triggerTime: "..." }]
   */
  SCHEDULED_NOTIFICATIONS: 'racesync:scheduled-notifications',

  /**
   * Currently selected race filter
   * Type: String ('all' | 'daily' | 'weekly' | 'special' | 'favorites')
   * Example: "daily"
   */
  SELECTED_FILTER: 'racesync:selected-filter',

  /**
   * User's theme preference
   * Type: String ('light' | 'dark' | 'system')
   * Example: "system"
   */
  THEME: 'racesync:theme',
} as const;

/**
 * Storage key prefix for bulk operations
 */
export const STORAGE_PREFIX = 'racesync:' as const;

/**
 * Type representing any valid storage key
 */
export type StorageKey = typeof STORAGE_KEYS[keyof typeof STORAGE_KEYS];

/**
 * Example usage:
 *
 * ```typescript
 * import AsyncStorage from '@react-native-async-storage/async-storage';
 * import { STORAGE_KEYS } from '@/shared/constants/storageKeys';
 *
 * // Save schedule to storage
 * await AsyncStorage.setItem(
 *   STORAGE_KEYS.SCHEDULE,
 *   JSON.stringify(scheduleData)
 * );
 *
 * // Load favorites from storage
 * const favoritesJson = await AsyncStorage.getItem(STORAGE_KEYS.FAVORITES);
 * const favorites = favoritesJson ? JSON.parse(favoritesJson) : [];
 *
 * // Check last update time
 * const lastUpdated = await AsyncStorage.getItem(STORAGE_KEYS.SCHEDULE_LAST_UPDATED);
 * ```
 */
```

## Deliverables

Create **2 files total**:

1. `src/data/sampleSchedule.json` (sample race data with 7+ races)
2. `src/shared/constants/storageKeys.ts` (storage key constants with types)

## Success Criteria

- ✅ `sampleSchedule.json` is valid JSON (no parse errors)
- ✅ All race objects match the Race type definition exactly
- ✅ At least 7 races included (3 daily, 2 weekly, 2 special)
- ✅ All timestamps are valid ISO 8601 UTC format
- ✅ UUIDs are properly formatted (v4 format)
- ✅ `storageKeys.ts` compiles with TypeScript strict mode
- ✅ All storage keys are properly typed and documented
- ✅ JSDoc comments include examples

## Testing

After creating the files, you should be able to:

1. **Import sample data:**
```typescript
import sampleSchedule from '../data/sampleSchedule.json';
console.log(sampleSchedule.dailyRaces.tierA.length); // Should output number of tier A races
```

2. **Use storage keys:**
```typescript
import { STORAGE_KEYS } from '../shared/constants/storageKeys';
const key: StorageKey = STORAGE_KEYS.SCHEDULE; // Type-safe
```

3. **Validate data:**
```typescript
import { Race } from '../features/schedules/types/Race';
import sampleSchedule from '../data/sampleSchedule.json';

// All races should match Race type
const race: Race = sampleSchedule.dailyRaces.tierA[0];
```

## Notes

- **Timestamps:** Use dates close to "now" so races appear as upcoming/live in testing
- **Track names:** Must match actual Le Mans Ultimate circuits
- **Car classes:** Only use valid classes from the Race type definition
- **UUIDs:** Use a UUID generator (v4 format): https://www.uuidgenerator.net/
- **File size:** `sampleSchedule.json` should be ~200-400 lines (readable, not minified)

## Ready to Start?

Create both files with:
1. Realistic, diverse race data for testing
2. Properly typed storage key constants
3. Comprehensive documentation

When complete, provide both files with complete content.

---

**After completion**, provide:
1. Complete `sampleSchedule.json` file (formatted, not minified)
2. Complete `storageKeys.ts` file
3. Confirmation that JSON is valid and TypeScript compiles
